import{U as V,_ as v}from"./UiParentCard.vue_vue_type_script_setup_true_lang.1729849390362.js";import{_ as y}from"./_plugin-vue_export-helper.1729849390362.js";import{o as c,e as u,w as l,b as o,c as P,E as L,F as $,Q as k,T as S,D as d,S as T,a as r,t as f,X as A,O as b,p as g,V as U,d as B,Y as N,Z as w,k as _}from"./index.1729849390362.js";import{G as E,a as O}from"./authStore.1729849390362.js";const D={components:{UiPlayerAndAccountName:V},props:{players:Array}};function F(e,t,a,s,p,m){const n=d("UiPlayerAndAccountName");return c(),u(S,{elevation:"10",class:"mt-4"},{default:l(()=>[o(k,null,{default:l(()=>[(c(!0),P($,null,L(a.players,i=>(c(),u(T,{key:i.account,cols:"12",md:"4",lg:"3",class:"cardBordered"},{default:l(()=>[o(n,{account:i.account,charname:i.name},null,8,["account","charname"])]),_:2},1024))),128))]),_:1})]),_:1})}const G=y(D,[["render",F]]),j={props:{players:Array}},x=["onClick"];function I(e,t,a,s,p,m){return c(),u(S,{elevation:"10",class:"mt-4"},{default:l(()=>[o(A,{hover:!0,items:a.players,class:"elevation-1"},{header:l(()=>t[0]||(t[0]=[r("thead",null,[r("tr",null,[r("th",{class:"h1"}," Character "),r("th",{class:"h1"}," Account ")])],-1)])),item:l(({item:n})=>[r("tr",{onClick:i=>{this.$router.push({name:"inspect-player",params:{accountname:n.account,charname:n.name}})}},[r("td",null,f(n.name),1),r("td",null,f(n.account),1)],8,x)]),_:1},8,["items"])]),_:1})}const R=y(j,[["render",I]]),z=()=>fetch(`${E()}/api/players/online`,{method:"GET",headers:{Authorization:`Bearer ${O().getToken()}`,"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{let t=[];return e[0].v>=0&&(e=e.slice(1),e.forEach(s=>{let p={name:s.charname,account:s.account};t.push(p)})),t}).catch(e=>(console.error("Error fetching players:",e),[{name:"Fetching data...",account:""}])),H=b("playerListStore",{state:()=>({list:[]}),actions:{updatePlayerList(e){this.list=e}}}),Q={components:{PlayerList:G,UiParentCard:v,PlayerListTable:R},data:()=>({listStyle:localStorage.getItem("listStyle")||"Card"}),watch:{listStyle(e){localStorage.setItem("listStyle",e)}},setup(){const e=g(()=>t.list),t=H();async function a(){z().then(s=>{t.updatePlayerList(s)})}return e.value.length<=0&&a(),{players:e,usePlayerListStore:t,updatePlayers:a}}};function X(e,t,a,s,p,m){const n=d("UiParentCard"),i=d("PlayerList"),C=d("PlayerListTable");return c(),P($,null,[o(n,{title:"Online Players"},{action:l(()=>[o(U,{onClick:t[0]||(t[0]=h=>s.updatePlayers()),variant:"tonal",class:"mb-4 mt-4 ml-4"},{default:l(()=>t[2]||(t[2]=[B("Refresh list")])),_:1}),o(N),o(w,{modelValue:e.listStyle,"onUpdate:modelValue":t[1]||(t[1]=h=>e.listStyle=h),label:`Style: ${e.listStyle}`,"false-value":"Card","true-value":"Table","hide-details":"",class:"mr-4"},null,8,["modelValue","label"])]),_:1}),e.listStyle==="Card"?(c(),u(i,{key:0,players:this.players},null,8,["players"])):_("",!0),e.listStyle==="Table"?(c(),u(C,{key:1,players:this.players},null,8,["players"])):_("",!0)],64)}const K=y(Q,[["render",X]]);export{K as default};
